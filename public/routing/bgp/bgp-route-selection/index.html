<!DOCTYPE html>
<html lang="en-us" dir="ltr" class="scroll-smooth">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<meta name="robots" content="noindex, nofollow" />
<title>
Route Selection | ngeran[io]
</title>

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/theme.css">


      <script src="/js/main.js"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Allerta+Stencil&display=swap" rel="stylesheet">

</head>
<body class="bg-dust-800">

  
  
  
  <nav class="fixed top-0 left-0 right-0 z-50 bg-dust-800 border-b border-gray-700 mb-4">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center h-16">

        
        <div class="flex items-center">
          <a href="/" class="flex items-center gap-3">
            <div class="flex items-center">
              <span class="text-lg font-bold text-gray-100">ngeran</span>
              <span class="text-nord-frost-pale">[</span>
              <span class="text-nord-aurora-yellow">io</span>
              <span class="text-nord-frost-pale">]</span>
            </div>
          </a>
          
          <div class="navbar-separator ml-6"></div>
        </div>

        
        <div class="hidden lg:flex lg:items-center">
          
            
              
              <a href="/" class="nav-link flex items-center gap-2 px-4 py-3 text-gray-100 hover:bg-dust-900 hover:text-moon rounded transition-all duration-200" style="text-decoration: none; font-size: 1rem;">
                <span class="capitalize">home</span>
              </a>
            
          
            
              
              <div class="relative group">
                <a href="/routing/" class="nav-link flex items-center gap-2 px-4 py-3 text-gray-100 hover:bg-dust-900 hover:text-moon rounded transition-all duration-200" style="text-decoration: none; font-size: 1rem;">
                  <span class="text-moon font-bold text-lg leading-none">+</span>
                  <span class="capitalize">blog</span>
                </a>

                
                <div class="megamenu-dropdown absolute left-1/2 -translate-x-1/2 top-full mt-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 ease-out transform translate-y-2 group-hover:translate-y-0 z-50" style="width: 400px;">
                  <div class="bg-dust-800 shadow-2xl overflow-hidden">
                    
                    <div class="px-6 py-4 border-b border-gray-700/50 bg-gradient-to-r from-[#5e81ac]/10 to-[#81a1c1]/10">
                      <h3 class="text-lg font-semibold text-moon">blog</h3>
                      <p class="text-sm text-dust-400 mt-1">Routing protocols study materials</p>
                    </div>

                    
                    <div class="p-2">
                      
                        <a href="/routing/bgp/" class="group/item flex items-center gap-4 px-4 py-3 hover:bg-dust-900 transition-all duration-200 border-b border-gray-700/50 menu-item-border">
                          
                          <div class="w-10 h-10 flex items-center justify-center">
                            
                              <svg class="w-5 h-5 text-nord-frost-pale group-hover/item:text-moon group-hover/item:scale-110 transition-all duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                              </svg>
                            
                          </div>

                          
                          <div class="flex-1">
                            <h4 class="font-medium text-gray-100 group-hover/item:text-moon transition-colors duration-200">b.g.p</h4>
                          </div>

                          
                          <svg class="w-5 h-5 text-gray-600 group-hover/item:text-moon group-hover/item:scale-110 transition-all duration-200" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M7 9C7.55228 9 8 8.55228 8 8C8 7.44772 7.55228 7 7 7C6.44772 7 6 7.44772 6 8C6 8.55228 6.44772 9 7 9Z" fill="currentColor"></path>
                            <path d="M9 11C9.55228 11 10 10.5523 10 10C10 9.44772 9.55228 9 9 9C8.44772 9 8 9.44772 8 10C8 10.5523 8.44772 11 9 11Z" fill="currentColor"></path>
                            <path d="M11 13C11.5523 13 12 12.5523 12 12C12 11.4477 11.5523 11 11 11C10.4477 11 10 11.4477 10 12C10 12.5523 10.4477 13 11 13Z" fill="currentColor"></path>
                            <path d="M9 15C9.55228 15 10 14.5523 10 14C10 13.4477 9.55228 13 9 13C8.44772 13 8 13.4477 8 14C8 14.5523 8.44772 15 9 15Z" fill="currentColor"></path>
                            <path d="M7 17C7.55228 17 8 16.5523 8 16C8 15.4477 7.55228 15 7 15C6.44772 15 6 15.4477 6 16C6 16.5523 6.44772 17 7 17Z" fill="currentColor"></path>
                            <path d="M14 9C14.5523 9 15 8.55228 15 8C15 7.44772 14.5523 7 14 7C13.4477 7 13 7.44772 13 8C13 8.55228 13.4477 9 14 9Z" fill="currentColor"></path>
                            <path d="M16 11C16.5523 11 17 10.5523 17 10C17 9.44772 16.5523 9 16 9C15.4477 9 15 9.44772 15 10C15 10.5523 15.4477 11 16 11Z" fill="currentColor"></path>
                            <path d="M18 13C18.5523 13 19 12.5523 19 12C19 11.4477 18.5523 11 18 11C17.4477 11 17 11.4477 17 12C17 12.5523 17.4477 13 18 13Z" fill="currentColor"></path>
                            <path d="M16 15C16.5523 15 17 14.5523 17 14C17 13.4477 16.5523 13 16 13C15.4477 13 15 13.4477 15 14C15 14.5523 15.4477 15 16 15Z" fill="currentColor"></path>
                            <path d="M14 17C14.5523 17 15 16.5523 15 16C15 15.4477 14.5523 15 14 15C13.4477 15 13 15.4477 13 16C13 16.5523 13.4477 17 14 17Z" fill="currentColor"></path>
                          </svg>
                        </a>
                      
                        <a href="/routing/mpls/" class="group/item flex items-center gap-4 px-4 py-3 hover:bg-dust-900 transition-all duration-200 border-b border-gray-700/50 menu-item-border">
                          
                          <div class="w-10 h-10 flex items-center justify-center">
                            
                              <svg class="w-5 h-5 text-nord-frost-pale group-hover/item:text-moon group-hover/item:scale-110 transition-all duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                              </svg>
                            
                          </div>

                          
                          <div class="flex-1">
                            <h4 class="font-medium text-gray-100 group-hover/item:text-moon transition-colors duration-200">m.p.l.s</h4>
                          </div>

                          
                          <svg class="w-5 h-5 text-gray-600 group-hover/item:text-moon group-hover/item:scale-110 transition-all duration-200" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M7 9C7.55228 9 8 8.55228 8 8C8 7.44772 7.55228 7 7 7C6.44772 7 6 7.44772 6 8C6 8.55228 6.44772 9 7 9Z" fill="currentColor"></path>
                            <path d="M9 11C9.55228 11 10 10.5523 10 10C10 9.44772 9.55228 9 9 9C8.44772 9 8 9.44772 8 10C8 10.5523 8.44772 11 9 11Z" fill="currentColor"></path>
                            <path d="M11 13C11.5523 13 12 12.5523 12 12C12 11.4477 11.5523 11 11 11C10.4477 11 10 11.4477 10 12C10 12.5523 10.4477 13 11 13Z" fill="currentColor"></path>
                            <path d="M9 15C9.55228 15 10 14.5523 10 14C10 13.4477 9.55228 13 9 13C8.44772 13 8 13.4477 8 14C8 14.5523 8.44772 15 9 15Z" fill="currentColor"></path>
                            <path d="M7 17C7.55228 17 8 16.5523 8 16C8 15.4477 7.55228 15 7 15C6.44772 15 6 15.4477 6 16C6 16.5523 6.44772 17 7 17Z" fill="currentColor"></path>
                            <path d="M14 9C14.5523 9 15 8.55228 15 8C15 7.44772 14.5523 7 14 7C13.4477 7 13 7.44772 13 8C13 8.55228 13.4477 9 14 9Z" fill="currentColor"></path>
                            <path d="M16 11C16.5523 11 17 10.5523 17 10C17 9.44772 16.5523 9 16 9C15.4477 9 15 9.44772 15 10C15 10.5523 15.4477 11 16 11Z" fill="currentColor"></path>
                            <path d="M18 13C18.5523 13 19 12.5523 19 12C19 11.4477 18.5523 11 18 11C17.4477 11 17 11.4477 17 12C17 12.5523 17.4477 13 18 13Z" fill="currentColor"></path>
                            <path d="M16 15C16.5523 15 17 14.5523 17 14C17 13.4477 16.5523 13 16 13C15.4477 13 15 13.4477 15 14C15 14.5523 15.4477 15 16 15Z" fill="currentColor"></path>
                            <path d="M14 17C14.5523 17 15 16.5523 15 16C15 15.4477 14.5523 15 14 15C13.4477 15 13 15.4477 13 16C13 16.5523 13.4477 17 14 17Z" fill="currentColor"></path>
                          </svg>
                        </a>
                      
                        <a href="/routing/ospf/" class="group/item flex items-center gap-4 px-4 py-3 hover:bg-dust-900 transition-all duration-200 border-b border-gray-700/50 menu-item-border">
                          
                          <div class="w-10 h-10 flex items-center justify-center">
                            
                              <svg class="w-5 h-5 text-nord-frost-pale group-hover/item:text-moon group-hover/item:scale-110 transition-all duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                              </svg>
                            
                          </div>

                          
                          <div class="flex-1">
                            <h4 class="font-medium text-gray-100 group-hover/item:text-moon transition-colors duration-200">o.s.p.f</h4>
                          </div>

                          
                          <svg class="w-5 h-5 text-gray-600 group-hover/item:text-moon group-hover/item:scale-110 transition-all duration-200" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M7 9C7.55228 9 8 8.55228 8 8C8 7.44772 7.55228 7 7 7C6.44772 7 6 7.44772 6 8C6 8.55228 6.44772 9 7 9Z" fill="currentColor"></path>
                            <path d="M9 11C9.55228 11 10 10.5523 10 10C10 9.44772 9.55228 9 9 9C8.44772 9 8 9.44772 8 10C8 10.5523 8.44772 11 9 11Z" fill="currentColor"></path>
                            <path d="M11 13C11.5523 13 12 12.5523 12 12C12 11.4477 11.5523 11 11 11C10.4477 11 10 11.4477 10 12C10 12.5523 10.4477 13 11 13Z" fill="currentColor"></path>
                            <path d="M9 15C9.55228 15 10 14.5523 10 14C10 13.4477 9.55228 13 9 13C8.44772 13 8 13.4477 8 14C8 14.5523 8.44772 15 9 15Z" fill="currentColor"></path>
                            <path d="M7 17C7.55228 17 8 16.5523 8 16C8 15.4477 7.55228 15 7 15C6.44772 15 6 15.4477 6 16C6 16.5523 6.44772 17 7 17Z" fill="currentColor"></path>
                            <path d="M14 9C14.5523 9 15 8.55228 15 8C15 7.44772 14.5523 7 14 7C13.4477 7 13 7.44772 13 8C13 8.55228 13.4477 9 14 9Z" fill="currentColor"></path>
                            <path d="M16 11C16.5523 11 17 10.5523 17 10C17 9.44772 16.5523 9 16 9C15.4477 9 15 9.44772 15 10C15 10.5523 15.4477 11 16 11Z" fill="currentColor"></path>
                            <path d="M18 13C18.5523 13 19 12.5523 19 12C19 11.4477 18.5523 11 18 11C17.4477 11 17 11.4477 17 12C17 12.5523 17.4477 13 18 13Z" fill="currentColor"></path>
                            <path d="M16 15C16.5523 15 17 14.5523 17 14C17 13.4477 16.5523 13 16 13C15.4477 13 15 13.4477 15 14C15 14.5523 15.4477 15 16 15Z" fill="currentColor"></path>
                            <path d="M14 17C14.5523 17 15 16.5523 15 16C15 15.4477 14.5523 15 14 15C13.4477 15 13 15.4477 13 16C13 16.5523 13.4477 17 14 17Z" fill="currentColor"></path>
                          </svg>
                        </a>
                      
                    </div>

                      
                      <div class="mt-6 pt-4 border-t border-gray-700/50 flex items-center justify-between">
                        <span class="text-sm text-dust-400">
                          <span class="text-moon font-semibold">3</span> protocols available
                        </span>
                        <a href="/routing/" class="text-sm text-nord-frost-pale hover:text-moon transition-colors duration-200 font-medium inline-flex items-center gap-1">
                          Browse all
                          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                          </svg>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            
          
            
              
              <a href="/projects/" class="nav-link flex items-center gap-2 px-4 py-3 text-gray-100 hover:bg-dust-900 hover:text-moon rounded transition-all duration-200" style="text-decoration: none; font-size: 1rem;">
                <span class="capitalize">projects</span>
              </a>
            
          
        </div>

        
        <div class="lg:hidden">
          <button id="mobile-menu-button" class="text-gray-100 focus:outline-none">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>

      </div>

      
      <div id="mobile-menu" class="hidden lg:hidden pb-4">
        <div class="pt-2 space-y-1">
          
            
              
              <a href="/" class="block px-3 py-2 text-gray-100 hover:bg-dust-900 rounded-lg font-medium">
                home
              </a>
            
          
            
              
              <div class="px-3 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">blog</div>
              
                <a href="/routing/bgp/" class="block px-4 py-2 text-gray-100 hover:bg-dust-900 rounded-lg">
                  b.g.p
                </a>
              
                <a href="/routing/mpls/" class="block px-4 py-2 text-gray-100 hover:bg-dust-900 rounded-lg">
                  m.p.l.s
                </a>
              
                <a href="/routing/ospf/" class="block px-4 py-2 text-gray-100 hover:bg-dust-900 rounded-lg">
                  o.s.p.f
                </a>
              
            
          
            
              
              <a href="/projects/" class="block px-3 py-2 text-gray-100 hover:bg-dust-900 rounded-lg font-medium">
                projects
              </a>
            
          
        </div>
      </div>

    </div>
  </nav>

  <div class="relative flex flex-col grow pt-16">
    <main class="grow">
      <article>
        <div class="max-w-4xl pr-6 sm:px-8 lg:px-12" style="padding-left: 4.5rem !important;">
          
          <div id="hero" class="h-[50px]"></div>

          
          <header class="mt-5 max-w-prose" style="padding-left: 4.5rem !important;">
            <h1 class="mt-0 text-4xl font-extrabold text-[#5e81ac]">Route Selection</h1>
            <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
              <div class="flex flex-row flex-wrap items-center">
                
                
                <time datetime="2024-12-01T09:15:27-05:00">December 1, 2024</time>
                <span class="px-2 text-primary-500">.</span>
                <span>2414 words</span>
                <span class="px-2 text-primary-500">.</span>
                <span>12 minutes</span>
              </div>
              <div class="flex flex-row flex-wrap items-center">
                
                


              </div>
            </div>

            
            <div class="flex author">
              
              <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
              alt="ngeran a.k.a nikos" src="/author/avatar.png" />
              <div class="place-self-center">
                <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div>
                <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">ngeran a.k.a nikos</div>
                <div class="text-2xl sm:text-lg"></div>
              </div>
            </div>
            <div class="mb-5"></div>
          </header>

          
          <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
            
            <div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
              <div class="ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">
                <div class="mt-0 overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
                  <div class="min-w-[220px] py-2 border-dotted list-none ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600 text-sm">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#best-path-selection">Best Path Selection</a></li>
    <li><a href="#lowest-route-preference">Lowest Route Preference</a></li>
    <li><a href="#highest-local-preference">Highest Local Preference</a></li>
    <li><a href="#shortest-as-path">Shortest AS Path</a></li>
    <li><a href="#lowest-origin">Lowest Origin</a></li>
    <li><a href="#lowest-med">Lowest MED</a></li>
    <li><a href="#route-type">Route Type</a></li>
    <li><a href="#lowest-igp-cost">Lowest IGP cost</a></li>
    <li><a href="#lowest-r-id-or-oldest-active">Lowest R-ID or Oldest Active</a></li>
    <li><a href="#cluster-list">Cluster List</a></li>
    <li><a href="#lowest-peer-ip">Lowest Peer IP</a></li>
  </ul>
</nav>
                  </div>
                </div>
              </div>
            </div>

            
            <div class="min-w-0 min-h-0 max-w-fit" style="padding-left: 4.5rem !important;">
              <div class="article-content max-w-prose mb-20 prose-h3:text-[#5e81ac]">
                
                <blockquote>
<p>Before the router even starts the route selection process it needs to make sure that the route is valid, checks the <strong>Martian</strong> routes, <strong>AS loops</strong> and <strong>next-hop reachability</strong>.</p>
</blockquote>
<h2 id="best-path-selection">Best Path Selection</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Attribute</th>
          <th style="text-align: left">Preference</th>
          <th style="text-align: left">Default Behavior</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">1. Route Preference</td>
          <td style="text-align: left">Lowest</td>
          <td style="text-align: left">Default value is 170</td>
      </tr>
      <tr>
          <td style="text-align: left">2. Local Preference</td>
          <td style="text-align: left">Highest</td>
          <td style="text-align: left">Default learned value is 100</td>
      </tr>
      <tr>
          <td style="text-align: left">3. AS-Path</td>
          <td style="text-align: left">Shortest</td>
          <td style="text-align: left">Usualy the first time route selection occurs</td>
      </tr>
      <tr>
          <td style="text-align: left">4. Origin</td>
          <td style="text-align: left">Lowest</td>
          <td style="text-align: left">IGP (I) &gt;  EGP (E), EGP &gt; incomplete (?)</td>
      </tr>
      <tr>
          <td style="text-align: left">5. Multi Exit Discriminator (MED)</td>
          <td style="text-align: left">Lowest</td>
          <td style="text-align: left">Compared when routes are learned from the same AS</td>
      </tr>
      <tr>
          <td style="text-align: left">6. Route Type</td>
          <td style="text-align: left">External</td>
          <td style="text-align: left">Internal vs External, External prefered</td>
      </tr>
      <tr>
          <td style="text-align: left">7. IGP Cost</td>
          <td style="text-align: left">Lowest</td>
          <td style="text-align: left">lowest cost towards the BGP next-hop</td>
      </tr>
      <tr>
          <td style="text-align: left">8. Internal vs External</td>
          <td style="text-align: left">Lowest</td>
          <td style="text-align: left">Lowest R-ID,  Oldest active route</td>
      </tr>
      <tr>
          <td style="text-align: left">10. Cluster List</td>
          <td style="text-align: left">Shortest</td>
          <td style="text-align: left">When route reflection is used</td>
      </tr>
      <tr>
          <td style="text-align: left">11. Peer IP Address</td>
          <td style="text-align: left">Lowest</td>
          <td style="text-align: left">Multiple peerings between the same router</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>For JUNOS the route selection results and criteria can be seen in the output of:</p>
</blockquote>
<ul>
<li><strong>show route details</strong></li>
<li><strong>show route extensive</strong></li>
</ul>
<h2 id="lowest-route-preference">Lowest Route Preference</h2>
<p>The Juniper default BGP preference is 170 below you can see a route selection which is based on a non-default route preference of 160.
Junos OS is kind enough to tell us why the second route has lost in the route selection.</p>
<blockquote>
<p>The Inactive Reason is <strong>Route Preference</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX4# run show route 192.168.250.0/24 exact detail       

inet.0: 14 destinations, 15 routes (14 active,0 holddown,0 hidden)
192.168.250.0/24 (2 entries, 1 announced)
        *BGP    Preference: 160/-101
                Next hop type: Router, Next hop index: 595
                Address: 0xc4b5f5c
                Next-hop reference count: 2
                Source: 10.100.34.1
                Next hop: 10.100.34.1 via ge-0/0/1.0,selected
                Session Id: 0x141
                State: &lt;Active Ext&gt;
                Local AS: 64533 Peer AS: 64522
                Age: 7 
                Validation State: unverified
                Task: BGP_64522.10.100.34.1
                Announcement bits(2):0-KRT 4-BGP_RT_Background
                AS path: 64522 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.3
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Router,Next hop index: 596
                Address: 0xc4b5ef4
                Next-hop reference count: 1
                Source: 10.100.24.1
                Next hop: 10.100.24.1 via ge-0/0/0.0,selected
                Session Id: 0x140
                State: &lt;Ext&gt;
                Inactive reason: Route Preference
                Local AS: 64533 Peer AS: 64522
                Age: 9:18 
                Validation State: unverified 
                Task: BGP_64522.10.100.24.1
                AS path: 64522 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.2
                Thread: junos-main 
</code></pre><h2 id="highest-local-preference">Highest Local Preference</h2>
<p>The default BGP <strong>Local Preference</strong> is 100 the route below has been selected for its higher non-default value of <strong>200</strong>.</p>
<blockquote>
<p>The Inactive Reason is <strong>Local Preference</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX4# run show route 192.168.250.0/24 exact detail 

inet.0: 14 destinations, 15 routes (14 active, 0 holddown, 0 hidden)
192.168.250.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-201
                Next hop type: Router, Next hop index: 595
                Address: 0xc4b5f5c
                Next-hop reference count: 2
                Source: 10.100.34.1
                Next hop: 10.100.34.1 via ge-0/0/1.0, selected
                Session Id: 0x141
                State: &lt;Active Ext&gt;
                Local AS: 64533 Peer AS: 64522
                Age: 24 
                Validation State: unverified 
                Task: BGP_64522.10.100.34.1
                Announcement bits (2): 0-KRT 4-BGP_RT_Background 
                AS path: 64522 I 
                Accepted
                Localpref: 200
                Router ID: 10.100.100.3
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 596
                Address: 0xc4b5ef4
                Next-hop reference count: 1
                Source: 10.100.24.1
                Next hop: 10.100.24.1 via ge-0/0/0.0, selected
                Session Id: 0x140
                State: &lt;Ext&gt;
                Inactive reason: Local Preference
                Local AS: 64533 Peer AS: 64522
                Age: 51:52 
                Validation State: unverified 
                Task: BGP_64522.10.100.24.1
                AS path: 64522 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.2
                Thread: junos-main 
</code></pre><h2 id="shortest-as-path">Shortest AS Path</h2>
<p>The route below has been selected because of its shortest AS Path.<br>
The selected route has 1 AS vs 5 AS.</p>
<blockquote>
<p>The Inactive Reason is <strong>AS Path</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX4# run show route 192.168.250.0/24 exact detail 

inet.0: 14 destinations, 15 routes (14 active, 0 holddown, 0 hidden)
192.168.250.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 596
                Address: 0xc4b5ef4
                Next-hop reference count: 2
                Source: 10.100.24.1
                Next hop: 10.100.24.1 via ge-0/0/0.0, selected
                Session Id: 0x140
                State: &lt;Active Ext&gt;
                Local AS: 64533 Peer AS: 64522
                Age: 1:23:04 
                Validation State: unverified 
                Task: BGP_64522.10.100.24.1
                Announcement bits (2): 0-KRT 4-BGP_RT_Background 
                AS path: 64522 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.2
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 595
                Address: 0xc4b5f5c
                Next-hop reference count: 1
                Source: 10.100.34.1
                Next hop: 10.100.34.1 via ge-0/0/1.0, selected
                Session Id: 0x141
                State: &lt;Ext&gt;
                Inactive reason: AS path
                Local AS: 64533 Peer AS: 64522
                Age: 15 
                Validation State: unverified 
                Task: BGP_64522.10.100.34.1
                AS path: 64522 64522 64522 64522 64522 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.3
                Thread: junos-main 
</code></pre><h2 id="lowest-origin">Lowest Origin</h2>
<p>The active route is chosen based on its lower origin setting of I (IGP), compared to the second route which has an origin of ? (Incomplete).</p>
<blockquote>
<p>The inactive reason is <strong>Origin</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX4# run show route 192.168.250.0/24 exact detail    

inet.0: 14 destinations, 15 routes (14 active, 0 holddown, 0 hidden)
192.168.250.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 596
                Address: 0xc4b5ef4
                Next-hop reference count: 2
                Source: 10.100.24.1
                Next hop: 10.100.24.1 via ge-0/0/0.0, selected
                Session Id: 0x140
                State: &lt;Active Ext&gt;
                Local AS: 64533 Peer AS: 64522
                Age: 1:45:36 
                Validation State: unverified 
                Task: BGP_64522.10.100.24.1
                Announcement bits (2): 0-KRT 4-BGP_RT_Background 
                AS path: 64522 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.2
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 595
                Address: 0xc4b5f5c
                Next-hop reference count: 1
                Source: 10.100.34.1
                Next hop: 10.100.34.1 via ge-0/0/1.0, selected
                Session Id: 0x141
                State: &lt;Ext Changed&gt;
                Inactive reason: Origin
                Local AS: 64533 Peer AS: 64522
                Age: 10 
                Validation State: unverified 
                Task: BGP_64522.10.100.34.1
                AS path: 64522 ? 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.3
                Thread: junos-main 
</code></pre><h2 id="lowest-med">Lowest MED</h2>
<p>The active route has a MED value of 20 shown as metric in the output.<br>
The second route has a MED of 150.</p>
<blockquote>
<p>Inactive reason <strong>Not Best in its group - Route Metric or MED comparison</strong></p>
</blockquote>
<pre tabindex="0"><code>jjcluser@vMX4# run show route 192.168.250.0/24 exact detail       

inet.0: 14 destinations, 15 routes (14 active, 0 holddown, 0 hidden)
192.168.250.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 595
                Address: 0xc4b5f5c
                Next-hop reference count: 2
                Source: 10.100.34.1
                Next hop: 10.100.34.1 via ge-0/0/1.0, selected
                Session Id: 0x141
                State: &lt;Active Ext&gt;
                Local AS: 64533 Peer AS: 64522
                Age: 36:03 Metric: 20 
                Validation State: unverified 
                Task: BGP_64522.10.100.34.1
                Announcement bits (2): 0-KRT 4-BGP_RT_Background 
                AS path: 64522 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.3
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 596
                Address: 0xc4b5ef4
                Next-hop reference count: 1
                Source: 10.100.24.1
                Next hop: 10.100.24.1 via ge-0/0/0.0, selected
                Session Id: 0x140
                State: &lt;NotBest Ext&gt;
                Inactive reason: Not Best in its group - 
                                 Route Metric or MED comparison
                Local AS: 64533 Peer AS: 64522
                Age: 13 Metric: 150 
                Validation State: unverified 
                Task: BGP_64522.10.100.24.1
                AS path: 64522 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.2
                Thread: junos-main
</code></pre><h2 id="route-type">Route Type</h2>
<p>The directly adverised external route is preferred over the external route learned via an internal neighbor.
This can be seen from the Local AS and Peer AS line.<br>
The <strong>Local AS</strong> and <strong>Peer AS</strong> line gives information on if the route is learned from an <br>
internal or external neighbor.<br>
The order of preference is:</p>
<ul>
<li>Local redistributed routes into BGP <strong>(Interior)</strong></li>
<li>External route directly learned from External BGP peers <strong>(Exterior)</strong></li>
<li>External route learned through an Internal BGP peer <strong>(Exterior via Interior)</strong></li>
</ul>
<blockquote>
<p>Inactive reason <strong>Interior &gt; Exterior &gt; Exterior via Interior</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX6# run show route 192.168.250.0/24 exact detail 

inet.0: 11 destinations, 12 routes (11 active, 0 holddown, 0 hidden)
192.168.250.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 587
                Address: 0xc4b5dbc
                Next-hop reference count: 2
                Source: 10.100.46.1
                Next hop: 10.100.46.1 via ge-0/0/3.0, selected
                Session Id: 0x141
                State: &lt;Active Ext&gt;
                Local AS: 64544 Peer AS: 64533
                Age: 50 
                Validation State: unverified 
                Task: BGP_64533.10.100.46.1
                Announcement bits (3):0-KRT 4-BGP_RT_Background 
                                     5-Resolve tree 1 
                AS path: 64533 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.4
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Indirect, Next hop index: 0
                Address: 0xc4b5d54
                Next-hop reference count: 1
                Source: 10.100.100.5
                Next hop type: Router, Next hop index: 349
                Next hop: 100.123.0.1 via fxp0.0, selected
                Session Id: 0x0
                Protocol next hop: 10.100.25.1
                Indirect next hop: 0xc61de84 338 INH Session ID: 0x0
                State: &lt;Int Ext&gt;
                Inactive reason: Interior &gt; 
                                 Exterior &gt; 
                                 Exterior via Interior
                Local AS: 64544 Peer AS: 64544
                Age: 6:58 Metric2: 0 
                Validation State: unverified 
                Task: BGP_64544.10.100.100.5
                AS path: 64522 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.5
                Thread: junos-main 
</code></pre><h2 id="lowest-igp-cost">Lowest IGP cost</h2>
<p>The active route is chosen based on the lowest IGP cost to the BGP next-hop, shown as protocol next-hop in the output.
The IGP cost is shown as metric2 in the output.<br>
The active route has a metric2 of 5 vs metric2 of 10 for the inactive.</p>
<blockquote>
<p>Inactive reason <strong>IGP metric</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX4# run show route 192.168.252.0/24 exact detail    

inet.0: 16 destinations, 18 routes (16 active, 0 holddown, 0 hidden)
192.168.252.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 595
                Address: 0xc4b5f5c
                Next-hop reference count: 3
                Source: 10.100.34.1
                Next hop: 10.100.34.1 via ge-0/0/1.0, selected
                Next hop: 10.100.24.1 via ge-0/0/1.0 
                Session Id: 0x141
                State: &lt;Active Ext&gt;
                Local AS: 64533 Peer AS: 64522
                Age: 16:59       Metric2: 5
                Validation State: unverified 
                Task: BGP_64522.10.100.34.1
                Announcement bits (2): 0-KRT 4-BGP_RT_Background 
                AS path: 64522 64544 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.3
                Thread: junos-main 
         BGP    Preference: 170/-101
                Address: 0xc4b5fc4
                Next-hop reference count: 2
                Source: 10.100.24.1
                Next hop type: Router, Next hop index: 0
                Next hop: 10.100.34.1 via ge-0/0/1.0, selected
                Next hop: 10.100.24.1 via ge-0/0/1.0 
                Session Id: 0x0
                State: &lt;NotBest Ext Changed&gt;
                Inactive reason: Not Best in its group - IGP metric
                Local AS: 64533 Peer AS: 64522
                Age: 16:59       Metric2: 10
                Validation State: unverified 
                Task: BGP_64522.10.100.24.1
                AS path: 64522 64544 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.2
                Thread: junos-main 
</code></pre><h2 id="lowest-r-id-or-oldest-active">Lowest R-ID or Oldest Active</h2>
<blockquote>
<p>Internal sessions <strong>Router-ID</strong></p>
</blockquote>
<p>The inactive route has a router-id 10.100.100.2 which is higher than the 10.100.100.1.</p>
<blockquote>
<p>Inactive reason <strong>Not Best in its group - Router ID</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX4# run show route 192.168.252.0/24 exact detail 

inet.0: 16 destinations, 18 routes (16 active, 0 holddown, 0 hidden)
192.168.252.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 595
                Address: 0xc4b5f5c
                Next-hop reference count: 2
                Source: 10.100.34.1
                Next hop: 10.100.34.1 via ge-0/0/1.0, selected
                Session Id: 0x141
                State: &lt;Active Ext&gt;
                Local AS: 64533 Peer AS: 64522
                Age: 1:00 
                Validation State: unverified 
                Task: BGP_64522.10.100.34.1
                Announcement bits (2): 0-KRT 4-BGP_RT_Background 
                AS path: 64522 64544 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.1
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 0
                Address: 0xc4b5fc4
                Next-hop reference count: 1
                Source: 10.100.24.1
                Next hop: 10.100.24.1 via ge-0/0/0.0, selected
                Session Id: 0x0
                State: &lt;NotBest Ext Changed&gt;
                Inactive reason: Not Best in its group - 
                                 Router ID
                Local AS: 64533 Peer AS: 64522
                Age: 1:00 
                Validation State: unverified 
                Task: BGP_64522.10.100.24.1
                AS path: 64522 64544 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.2
                Thread: junos-main 
</code></pre><blockquote>
<p>External sessions <strong>Router-ID</strong></p>
</blockquote>
<p>To use the Router-ID as a tie-breaker the command <strong>path-selection external-router-id</strong> needs to be coinfigured.
The inactive route behaves as the internal and has a router-id 10.100.100.2 which is higher than the 10.100.100.1.</p>
<blockquote>
<p>Inactive reason <strong>Not Best in its group - Router ID</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX4# run show route 192.168.252.0/24 exact detail 

inet.0: 16 destinations, 18 routes (16 active, 0 holddown, 0 hidden)
192.168.252.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 595
                Address: 0xc4b5f5c
                Next-hop reference count: 2
                Source: 10.100.34.1
                Next hop: 10.100.34.1 via ge-0/0/1.0, selected
                Session Id: 0x141
                State: &lt;Active Ext&gt;
                Local AS: 64533 Peer AS: 64522
                Age: 1:00       Metric2: 5 
                Validation State: unverified 
                Task: BGP_64522.10.100.34.1
                Announcement bits (2): 0-KRT 4-BGP_RT_Background 
                AS path: 64522 64544 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.1
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 0
                Address: 0xc4b5fc4
                Next-hop reference count: 1
                Source: 10.100.24.1
                Next hop: 10.100.24.1 via ge-0/0/0.0, selected
                Session Id: 0x0
                State: &lt;NotBest Ext Changed&gt;
                Inactive reason: Not Best in its group - 
                                 Router ID
                Local AS: 64533 Peer AS: 64522
                Age: 1:00
                Validation State: unverified 
                Task: BGP_64522.10.100.24.1
                AS path: 64522 64544 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.2
                Thread: junos-main 
</code></pre><blockquote>
<p>External sessions</p>
</blockquote>
<p>For Satbility reasons the oldest route is prefered</p>
<blockquote>
<p>The inactive reason <strong>Not Best in its group - Active preferred</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX4# run show route 192.168.252.0/24 exact detail 

inet.0: 16 destinations, 18 routes (16 active, 0 holddown, 0 hidden)
192.168.252.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 595
                Address: 0xc4b5f5c
                Next-hop reference count: 2
                Source: 10.100.34.1
                Next hop: 10.100.34.1 via ge-0/0/1.0, selected
                Session Id: 0x141
                State: &lt;Active Ext&gt;
                Local AS: 64533 Peer AS: 64522
                Age: 1:00 
                Validation State: unverified 
                Task: BGP_64522.10.100.34.1
                Announcement bits (2): 0-KRT 4-BGP_RT_Background 
                AS path: 64522 64544 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.3
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Router, Next hop index: 0
                Address: 0xc4b5fc4
                Next-hop reference count: 1
                Source: 10.100.24.1
                Next hop: 10.100.24.1 via ge-0/0/0.0, selected
                Session Id: 0x0
                State: &lt;NotBest Ext Changed&gt;
                Inactive reason: Not Best in its group - 
                                 Active preferred
                Local AS: 64533 Peer AS: 64522
                Age: 1:00 
                Validation State: unverified 
                Task: BGP_64522.10.100.24.1
                AS path: 64522 64544 I 
                Accepted
                Localpref: 100
                Router ID: 10.100.100.2
                Thread: junos-main 
</code></pre><h2 id="cluster-list">Cluster List</h2>
<p>The shortest cluster list will be preferred when we have multiple route reflectors.</p>
<blockquote>
<p>Inactive reason <strong>Not Best in its group - Cluster list length</strong></p>
</blockquote>
<pre tabindex="0"><code>Output TBD 
</code></pre><h2 id="lowest-peer-ip">Lowest Peer IP</h2>
<p>This is the last tie-breaker we can come this when for load-balancing purposed two routers peer two or more time with eachother.
The route has been selected based on the lowest peer ip address, shown as <strong>Source</strong> in the output.</p>
<blockquote>
<p>Inactive reason is <strong>Not Best in its group - Update source</strong></p>
</blockquote>
<pre tabindex="0"><code>jcluser@vMX2# run show route 192.168.251.0/24 exact detail 

inet.0: 26 destinations, 27 routes (26 active, 0 holddown, 0 hidden)
192.168.251.0/24 (2 entries, 1 announced)
        *BGP    Preference: 170/-101
                Next hop type: Indirect, Next hop index: 0
                Address: 0xc4b6234
                Next-hop reference count: 3
                Source: 10.100.150.1
                Next hop type: Router, Next hop index: 607
                Next hop: 10.100.12.1 via ge-0/0/0.0, selected
                Session Id: 0x143
                Protocol next hop: 10.100.100.1
                Indirect next hop: 0xc633184 1048574 
                                   INH Session ID: 0x144
                State: &lt;Active Int Ext&gt;
                Local AS: 64500 Peer AS: 64500
                Age: 1:37 Metric2: 10 
                Validation State: unverified 
                ORR Generation-ID: 0 
                Task: BGP_64500.10.100.150.1
                Announcement bits (3): 0-KRT 4-BGP_RT_Background 
                                       5-Resolve tree 4 
                AS path: 64544 I  (Originator)
                Cluster list:  1.1.1.1
                Originator ID: 10.100.100.1
                Accepted
                Localpref: 100
                Router ID: 10.100.150.1
                Thread: junos-main 
         BGP    Preference: 170/-101
                Next hop type: Indirect, Next hop index: 0
                Address: 0xc4b6234
                Next-hop reference count: 3
                Source: 10.100.150.2
                Next hop type: Router, Next hop index: 607
                Next hop: 10.100.12.1 via ge-0/0/0.0, selected
                Session Id: 0x143
                Protocol next hop: 10.100.100.1
                Indirect next hop: 0xc633184 1048574 
                                   INH Session ID: 0x144
                State: &lt;NotBest Int Ext&gt;
                Inactive reason: Not Best in its group - 
                                 Update source
                Local AS: 64500 Peer AS: 64500
                Age: 1:37 Metric2: 10 
                Validation State: unverified 
                ORR Generation-ID: 0 
                Task: BGP_64500.10.100.150.2
                AS path: 64544 I  (Originator)
                Cluster list:  2.2.2.2
                Originator ID: 10.100.100.1
                Accepted
                Localpref: 100
                Router ID: 10.100.150.2
                Thread: junos-main 
</code></pre>
                
              </div>
              
                <div class="flex justify-between">
  
  <div class="">
    
    <a
      href="http://localhost:1313/routing/bgp/fsm/?ref=footer"
      class="flex items-center justify-center px-3 h-8 me-3 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
    >
      <svg
        class="w-3.5 h-3.5 me-2 rtl:rotate-180"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 14 10"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M13 5H1m0 0 4 4M1 5l4-4"
        />
      </svg>
      Previous
    </a>
    
  </div>
  
  <div class="">
    
    <a
      href="http://localhost:1313/routing/bgp/bgp-attributes/?ref=footer"
      class="flex items-center justify-center px-3 h-8 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white"
    >
      Next
      <svg
        class="w-3.5 h-3.5 ms-2 rtl:rotate-180"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 14 10"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M1 5h12m0 0L9 1m4 4L9 9"
        />
      </svg>
    </a>
    
  </div>
</div>

              
            </div>
          </section>
        </div>
      </article>
    </main>
  </div>

  <footer>
    <footer class="mx-auto w-full  max-w-container text-center" >
    
   <div class="max-w-screen-xl sm:pt-5 md:pt-8 pt-0">
       <div class="border-b border-[#4c566a] mb-5 flex justify-between"></div>
   </div> 
   <div class="flex flex-col items-center ">
       
       <div id="logo">
           <span class="text-[#5e81ac]">ngeran[</span><span class="text-[#ebcb8b]">io</span><span class="text-[#5e81ac]">]</span>
       </div>
       <p class="mt-5 text-center text-sm leading-6 text-slate-500">Â© Copyright 2026. All rights reserved.</p>
       <div class="mt-4 flex items-center justify-center space-x-4 text-sm font-semibold leading-6 text-slate-700"><a href="/privacy-policy">Privacy policy</a>
           <div class="h-4 w-px bg-slate-500/20"></div><a href="/changelog">Changelog</a>
       </div>
   </div>
</footer>
  </footer>



  
  <script>
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');

    mobileMenuButton?.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
  </script>
</body>
</html>
