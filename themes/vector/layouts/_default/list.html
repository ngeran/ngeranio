{{ define "main" }}
<!-- ============================================ -->
<!-- MAIN CONTENT SECTION                          -->
<!-- ============================================ -->
<section class="pt-12 pb-12 px-6 sm:px-8 lg:px-12 list-page-section">
  <div class="max-w-7xl mx-auto">

    <!-- ============================================ -->
    <!-- SECTION HEADER                                -->
    <!-- ============================================ -->
    <div class="mb-16 text-center">
      <h1 class="text-4xl font-bold text-moon mb-4" style="font-family: 'Allerta Stencil', sans-serif;">
        {{ if eq .Title "Routing" }}
          Routing & Networking
        {{ else if eq .Title "OSPF Posts" }}
          OSPF
        {{ else if eq .Title "BGP Posts" }}
          BGP
        {{ else if eq .Title "MPLS Posts" }}
          MPLS
        {{ else }}
          {{ .Title }}
        {{ end }}
      </h1>
      <p class="text-base text-gray-300 leading-relaxed">
        {{ if eq .Title "OSPF Posts" }}
          Open Shortest Path First protocol concepts and configuration
        {{ else if eq .Title "BGP Posts" }}
          Border Gateway Protocol implementation and best practices
        {{ else if eq .Title "MPLS Posts" }}
          Multiprotocol Label Switching architecture and deployment
        {{ else }}
          JNCIE-SP study notes and networking knowledge
        {{ end }}
      </p>
    </div>

    <!-- ============================================ -->
    <!-- RESOURCES GRID - FIXED 3 COLUMN LAYOUT        -->
    <!-- ============================================ -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      {{ range .Pages }}
      {{ if not .Params.draft }}

      <!-- ============================================ -->
      <!-- SINGLE RESOURCE CARD                         -->
      <!-- ============================================ -->
      <article class="resource-item">
        <a href="{{ .RelPermalink }}" class="resource-link group block w-full border border-gray-700 rounded-2xl overflow-hidden">

          <!-- ============================================ -->
          <!-- CARD TOP - FEATURED IMAGE (457x304)           -->
          <!-- ============================================ -->
          <div class="resource-link-top w-full overflow-hidden bg-[#191a1f]/50 rounded-t-2xl" style="max-width: 457px;">
            {{ if .Params.featured_image }}
              <!-- Use page resources for proper image path resolution -->
              {{ with .Resources.GetMatch "featured*" }}
                <img src="{{ .RelPermalink }}"
                     alt="{{ .Title }}"
                     loading="lazy"
                     width="457"
                     height="304"
                     class="highlighted-resource-img w-full h-auto object-cover"
                     style="aspect-ratio: 457 / 304;">
              {{ else }}
                <!-- Fallback to direct path -->
                <img src="{{ .Params.featured_image | relURL }}"
                     alt="{{ .Title }}"
                     loading="lazy"
                     width="457"
                     height="304"
                     class="highlighted-resource-img w-full h-auto object-cover"
                     style="aspect-ratio: 457 / 304;"
                     onerror="this.style.display='none'">
              {{ end }}
            {{ else }}
              <!-- No image placeholder -->
              <div class="w-full bg-gradient-to-br from-[#5e81ac]/5 to-[#81a1c1]/5 flex items-center justify-center rounded-lg" style="aspect-ratio: 457 / 304;">
                <span class="text-4xl font-bold text-[#5e81ac]/10">{{ substr .Title 0 1 }}</span>
              </div>
            {{ end }}
          </div>

          <!-- ============================================ -->
          <!-- CARD BOTTOM - METADATA & CONTENT              -->
          <!-- ============================================ -->
          <div class="resource-link-bottom p-6 bg-[#2a2c33] rounded-b-2xl transition-colors duration-300 group-hover:bg-dust-900 text-center">

            <!-- Metadata row -->
            <div class="resource-metadata flex items-center justify-center gap-2 text-xs text-dust-400 mb-2">
              <!-- Category badge -->
              {{ if .Params.tags }}
                {{ with index .Params.tags 0 }}
                  <span class="text-style-uppercase font-semibold tracking-wider text-dust-400">
                    {{ . }}
                  </span>
                {{ end }}
              {{ end }}

              <!-- Separator -->
              <span class="text-dust-400">Â·</span>

              <!-- Date -->
              <div class="text-dust-400">
                <time datetime="{{ .Date.Format "2006-01-02" }}">
                  {{ .Date.Format "2 Jan 06" }}
                </time>
              </div>
            </div>

            <!-- Title -->
            <h2 class="heading-style-h5 text-lg font-semibold text-white mb-2 line-clamp-2 leading-snug group-hover:text-moon transition-colors duration-200">
              {{ .Title }}
            </h2>

            <!-- Summary/Description -->
            {{ with .Summary }}
              <p class="text-size-regular text-sm text-white line-clamp-2 leading-relaxed">
                {{ . }}
              </p>
            {{ end }}

          </div>
        </a>
      </article>
      <!-- END RESOURCE CARD -->

      {{ end }}
      {{ end }}
    </div>
    <!-- END GRID -->

  </div>
</section>

<!-- ============================================ -->
<!-- STYLES                                          -->
<!-- ============================================ -->
<style>
  /* Text clamping for multiline truncation */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
{{ end }}
